!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){var c={};c.toRGBA=function(a){return"rgba("+a[0]+","+a[1]+","+a[2]+","+(a[3]||1)+")"},c.lerp=function(a,b,c){var d=void 0===a[3]?1:a[3],e=void 0===b[3]?1:b[3],f=Math.round(Mathf.lerp(a[0],b[0],c)),g=Math.round(Mathf.lerp(a[1],b[1],c)),h=Math.round(Mathf.lerp(a[2],b[2],c)),i=Math.round(100*Mathf.lerp(d,e,c))/100;return[f,g,h,i]},c.eql=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]},b.exports=c},{}],2:[function(a,b){function c(a,b){var c,d;return a.pageX||a.pageY?(c=a.pageX,d=a.pageY):(c=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,d=a.clientY+document.body.scrollTop+document.documentElement.scrollTop),c-=b.offsetLeft,d-=b.offsetTop,{x:c,y:d}}var d=b.exports=function(a){this.container=a.container||window.document,this.events={pressing:null,moving:null,release:null,element:null,pause:null},this.enabled=!1,this.onMouseUp=this._onMouseUp.bind(this),this.onMouseDown=this._onMouseDown.bind(this),this.onMouseMove=this._onMouseMove.bind(this),this.keyUp=this._onKeyUp.bind(this),this.container.onmouseup=this.onMouseUp,this.container.onmousedown=this.onMouseDown,this.container.onmousemove=this.onMouseMove,window.document.onkeyup=this.keyUp};d.prototype.enable=function(){return this.enabled=!0,this},d.prototype.disable=function(){return this.enabled=!1,this},d.prototype.on=function(a,b){return this.events[a]||(this.events[a]=[]),this.events[a].push(b),this},d.prototype.off=function(a){return this.events[a]&&(this.events[a].length=0),this},d.prototype._getEventName=function(a){var b=a.which||a.keyCode;switch(b){case 81:case 113:return"element:fire";case 87:case 119:return"element:water";case 112:case 80:return"pause"}},d.prototype._onKeyUp=function(a){var b=this._getEventName(a);if((this.enabled||"pause"===b)&&b){if(b.indexOf("element")>-1){var c=b.split(":")[1];return void this.events.element.forEach(function(a){a(c)})}this.events[b].forEach(function(a){a()})}},d.prototype._onMouseUp=function(a){if(this.enabled){var b=c(a,this.container);this.events.release.forEach(function(a){a(b)})}},d.prototype._onMouseDown=function(a){if(this.enabled){var b=c(a,this.container);this.events.pressing.forEach(function(a){a(b)})}},d.prototype._onMouseMove=function(a){if(this.enabled){var b=c(a,this.container);this.events.moving.forEach(function(a){a(b)})}}},{}],3:[function(a,b){var c=b.exports=function(){this.pos={x:0,y:0},this.size=20,this.coldColor=[0,0,255,.5],this.burnColor=[255,0,0,.4],this.color=[255,255,255,.5],this.active=!1,this.element="fire",Controls.on("pressing",this.onPressing.bind(this)),Controls.on("moving",this.onMoving.bind(this)),Controls.on("release",this.onRelease.bind(this)),Controls.on("element",this.onElement.bind(this))};c.prototype.onPressing=function(a){this.pos=a,this.active=!0},c.prototype.onMoving=function(a){this.pos=a},c.prototype.onRelease=function(){this.active=!1},c.prototype.onElement=function(a){this.element=a},c.prototype.update=function(){switch(this.element){case"fire":this.color=this.burnColor;break;case"water":this.color=this.coldColor}},c.prototype.draw=function(a){Renderer.drawCircle(a,{pos:this.pos,radius:this.size,color:Color.toRGBA(this.color),stroke:{color:"#fff",size:2}})}},{}],4:[function(a,b){var c=a("./Manager"),d=b.exports=function(a){this.cview=a.viewport,this.cworld=a.world,this.viewCtx=null,this.worldCtx=null,this.tLoop=null,this.paused=!1,this.boundGameRun=this.gameRun.bind(this),this.manager=new c,this.initialize()};d.prototype.initialize=function(){var a=config.size;if(!this.cview.getContext)throw"canvas not supported!";this.cview.width=a.x,this.cview.height=a.y,this.viewCtx=this.cview.getContext("2d"),this.worldCtx=this.cworld.getContext("2d"),this.cworld.width=a.x,this.cworld.height=a.y},d.prototype.loop=function(){this.manager.update(),this.manager.draw(this.viewCtx,this.worldCtx)},d.prototype.start=function(){this.paused=!1,Controls.enable(),this.gameRun()},d.prototype.stop=function(){this.paused=!0,Controls.disable(),window.cancelAnimationFrame(this.tLoop)},d.prototype.gameRun=function(){Time.tick()&&this.loop(),this.tLoop=window.requestAnimationFrame(this.boundGameRun)}},{"./Manager":6}],5:[function(a,b){var c=b.exports=function(){this.lastTime=Date.now(),this.frameTime=0,this.deltaTime=0,this.typicalFrameTime=20,this.minFrameTime=12,this.time=0};c.prototype.tick=function(){var a=Date.now(),b=a-this.lastTime;return b<this.minFrameTime?!1:(this.frameTime=b>2*this.typicalFrameTime?this.typicalFrameTime:b,this.deltaTime=this.frameTime/1e3,this.time+=this.frameTime,this.lastTime=a,!0)},c.prototype.reset=function(){this.lastTime=Date.now(),this.frameTime=0,this.deltaTime=0,this.typicalFrameTime=20,this.minFrameTime=12,this.time=0}},{}],6:[function(a,b){var c=a("./Nodes"),d=a("./Paths"),e=a("./Cursor"),f=a("./Spiders"),g=b.exports=function(){this.cursor=new e,this.nodes=new c,this.paths=new d,this.spiders=new f(this.nodes)};g.prototype.update=function(){this.cursor.update(),this.cursor.active&&(this.nodes.applyPos=this.cursor.pos,this.nodes.applyRatio=this.cursor.size,this.nodes.element=this.cursor.element),this.nodes.update(),this.spiders.update()},g.prototype.draw=function(a,b){var c=config.size;a.clearRect(0,0,c.x,c.y),b.clearRect(0,0,c.x,c.y),this.cursor.draw(a),this.nodes.draw(b),this.spiders.draw(b)}},{"./Cursor":3,"./Nodes":9,"./Paths":11,"./Spiders":16}],7:[function(a,b){var c={};c.rnd=function(a,b){return Math.floor(Math.random()*(b-a+1)+a)},c.rnd11=function(){return Math.round(Math.random())},c.rnd01=function(){return Math.random()},c.rndAngle=function(){return Math.random()*Math.PI*2},c.rndInCircle=function(a){var b=c.rndAngle(),d=c.rnd(0,a);return{x:Math.cos(b)*d,y:Math.sin(b)*d}},c.lerp=function(a,b,c){return(1-c)*a+c*b},c.polygonPoints=function(a,b,c){for(var d=[],e=2*Math.PI/c,f=0;c>f;f++)d.push({x:a.x+b*Math.cos(f*e),y:a.y+b*Math.sin(f*e)});return d},b.exports=c},{}],8:[function(a,b){var c=b.exports=function(a){this.id=_.guid("nodes"),this.pos=a,this.size=config.nodes.size,this.color=config.nodes.colors.cold,this.dColor=Color.toRGBA(this.color),this.nears=[],this.selected=!1,this.incTempSize=.1,this.temp=0,this.incTemp=0,this.burnTemp=1,this.burned=!1};c.prototype.addNear=function(a){this.nears.push(a)},c.prototype.randomBurn=function(){var a=this.nears.some(function(a){return a.burned});!a&&Mathf.rnd01()<.15&&this.setBurned()},c.prototype.burn=function(){this.incTemp=1},c.prototype.cool=function(){this.incTemp=-1},c.prototype.getRandomNear=function(a){var b=[];if(this.nears.forEach(function(c){c.id!==a&&!c.burned&&c.temp<.5&&b.push(c)}),b.length>0){var c=Mathf.rnd(0,b.length-1);return b[c]}return null},c.prototype.setBurned=function(){this.burned=!0,this.color=config.nodes.colors.burned,this.dColor=Color.toRGBA(this.color)},c.prototype.update=function(){var a=this.nears.every(function(a){return a.burned});return a?void this.setBurned():(this.temp+=this.incTemp*this.incTempSize*Time.deltaTime,this.temp<=0&&(this.temp=0),this.color=Color.lerp(config.nodes.colors.cold,config.nodes.colors.burn,this.temp),this.dColor=Color.toRGBA(this.color),this.temp>1?void this.setBurned():void 0)},c.prototype.draw=function(a){Renderer.drawCircle(a,{pos:this.pos,radius:this.size,color:this.dColor})}},{}],9:[function(a,b){var c=a("./Node"),d=a("./Paths"),e=b.exports=function(){this.nodes=[],this.paths=new d;var a=Vector.divide(config.size,2),b=Vector.center(Vector.zero,config.size);this.createWeb(b,a),this.applyPos=null,this.applyRatio=0,this.element=null};e.prototype.createWeb=function(a,b){var d,e=0,f=25,g=f/5,h=40,i=Vector.add(a,Vector.multiply(b,-1)),j=Vector.add(a,b),k=[],l=40,m=1,n=0;do{d=!1;var o=Mathf.polygonPoints(a,m*f+l,h);n+=o.length;var p=[];(10===m||20===m)&&(g+=.1),o.forEach(function(a){var b=Vector.round(Vector.add(a,Mathf.rndInCircle(g))),e=new c(b);Vector.isOut(b,i,j)?e.out=!0:(d=!0,this.nodes.push(e)),p.push(e)},this),k[m-1]=p,m++}while(d);e=m-2;var q,r,s;for(q=0;e>q;q++){var t=k[q],u=t.length;for(r=0;u>r;r++){s=r+1,s>u-1&&(s=0);var v=k[q][s];if(!v.out){var w=k[q+1][s];e-1>q&&!w.out&&this.paths.addOne(v,w);var x=k[q][r];x.out||this.paths.addOne(v,x)}}}this.nodes.forEach(function(a){a.randomBurn()})},e.prototype.findNodeByCollider=function(){this.nodes.forEach(function(a){if(Vector.pointInCircle(this.applyPos,a.pos,this.applyRatio))switch(this.element){case"fire":a.burn();break;case"water":a.cool()}},this)},e.prototype.GetNodes=function(){return this.nodes},e.prototype.update=function(){this.applyPos&&this.findNodeByCollider(),this.paths.update(),this.nodes.forEach(function(a){a.burned||a.update()})},e.prototype.draw=function(a){this.paths.draw(a),this.nodes.forEach(function(b){b.draw(a)})}},{"./Node":8,"./Paths":11}],10:[function(a,b){var c=b.exports=function(a,b){this.na=a,this.nb=b,this.size=config.paths.size,this.tBurn=config.paths.tBurn,this.burned=!1};c.prototype.update=function(){var a=this.na.temp,b=this.nb.temp,c=this.na.color,d=this.nb.color;a>this.tBurn&&0===b?this.nb.burn():b>this.tBurn&&0===a&&this.na.burn(),this.color=Color.toRGBA(Color.eql(c,d)?c:Color.lerp(c,d,this.tBurn)),(this.na.burned||this.nb.burned)&&(this.burned=!0,this.color=Color.toRGBA(config.paths.colors.burned))},c.prototype.draw=function(a){Renderer.drawLine(a,{from:this.na.pos,to:this.nb.pos,size:this.size,color:this.color})}},{}],11:[function(a,b){var c=a("./Path"),d=b.exports=function(){this.paths=[]};d.prototype.hasOne=function(a,b){return this.paths.some(function(c){var d=c.na.id,e=c.nb.id;return!(a!==d&&a!==e||b!==d&&b!==e)})},d.prototype.addOne=function(a,b){b&&!this.hasOne(a.id,b.id)&&(a.addNear(b),b.addNear(a),this.paths.push(new c(a,b)))},d.prototype.update=function(){this.paths.forEach(function(a){a.burned||a.update()})},d.prototype.draw=function(a){this.paths.forEach(function(b){b.draw(a)})}},{"./Path":10}],12:[function(a,b){var c={};c.test=function(a,b){return{x:a,y:b}},b.exports=c},{}],13:[function(a,b){var c={};c.drawCircle=function(a,b){a.beginPath(),a.arc(b.pos.x,b.pos.y,b.radius,0,2*Math.PI,!1),a.fillStyle=b.color,a.fill(),b.stroke&&(a.lineWidth=b.stroke.size||1,a.strokeStyle=b.stroke.color||"#000",a.stroke())},c.drawLine=function(a,b){var c=b.from,d=b.to;a.beginPath(),a.moveTo(c.x,c.y),a.lineTo(d.x,d.y),a.lineWidth=b.size,a.strokeStyle=b.color,a.stroke()},c.drawRect=function(a,b){a.beginPath(),a.rect(b.pos.x,b.pos.y,b.size.x,b.size.y),a.lineWidth=1,a.strokeStyle="red",a.stroke()},b.exports=c},{}],14:[function(a,b){b.exports={nodes:{size:3,colors:{cold:[255,255,255,1],burn:[255,0,0,1],burned:[0,0,0,.2]}},paths:{size:2,tBurn:.5,colors:{burned:[0,0,0,.2]}},spiders:{size:5,quantity:50,color:[115,255,0],speed:.05,speedAlert:.1,behaviour:{alertTemp:0,tStayA:3e3,tStayB:1e4}}}},{}],15:[function(a,b){var c=b.exports=function(a){var b=config.spiders;this.pos=Vector.round(a),this.size=b.size,this.color=b.color,this.speed=b.speed,this.nFrom=null,this.nTo=null,this.journeyLength=null,this.traveling=!1,this.collider=3*this.size,this.isDead=!1,this.temp=0,this.staying=!1,this.t_stay=2e3,this.t_startStay=0,this.t_nextStay=0,this.t_startMove=0};c.prototype.setNode=function(a,b){this.nFrom=a,this.nTo=b,this.t_startMove=Time.time,this.journeyLength=Vector.length(a.pos,b.pos),this.traveling=!0},c.prototype.setDead=function(){this.isDead=!0},c.prototype.updateTemp=function(){var a=this.nFrom.temp,b=this.nTo.temp;return 0===a&&0===b?void(this.temp=0):a>b?void(this.temp=a):void(b>a&&(this.temp=b))},c.prototype.updateState=function(){var a=config.spiders,b=Time.time,c=a.behaviour,d=this.t_startStay,e=this.t_stay;return this.temp>c.alertTemp?(this.speed=a.speedAlert,this.staying&&(this.t_startMove+=b-d),void(this.staying=!1)):(this.speed=a.speed,void(this.staying?b>d+e&&(this.staying=!1,this.t_startMove+=e,this.t_nextStay=b+e/Mathf.rnd(2,5)):b>this.t_nextStay&&Mathf.rnd(0,1e3)>900&&(this.staying=!0,this.t_startStay=b,this.t_stay=Mathf.rnd(c.tStayA,c.tStayB))))},c.prototype.updateMove=function(){if(this.nFrom.burned||this.nTo.burned)return void this.setDead();if(!this.staying){var a=(Time.time-this.t_startMove)*this.speed,b=a/this.journeyLength;return b>1?(this.pos=this.nTo.pos,void(this.traveling=!1)):void(this.pos=Vector.round(Vector.lerp(this.nFrom.pos,this.nTo.pos,b)))}},c.prototype.update=function(){this.isDead||this.journeyLength&&(this.updateTemp(),this.updateState(),this.updateMove())},c.prototype.draw=function(a){this.isDead||Renderer.drawCircle(a,{pos:this.pos,radius:this.size,color:Color.toRGBA(this.color)})}},{}],16:[function(a,b){var c=a("./Spider"),d=b.exports=function(a){this.nodes=a,this.amount=config.spiders.quantity,this.spiders=[],this.generateSpiders()};d.prototype.generateSpiders=function(){for(var a=this.nodes.GetNodes(),b=a.length,d=[],e=0;e<this.amount;e++){var f=Mathf.rnd(0,b-1),g=a[f];-1===d.indexOf(g.id)&&(d.push(g.id),this.spiders.push(new c(g.pos)))}},d.prototype.update=function(){var a=this.nodes.GetNodes();this.spiders.forEach(function(b){b.traveling||a.forEach(function(a){if(Vector.pointInCircle(b.pos,a.pos,5)){var c=b.nodeFrom&&b.nodeFrom.id||-1,d=a.getRandomNear(c);d?b.setNode(a,d):a.burned&&b.setDead()}}),b.update()})},d.prototype.draw=function(a){this.spiders.forEach(function(b){b.draw(a)})}},{"./Spider":15}],17:[function(a,b){var c=b.exports=function(){this.lastIds={nodes:0}};c.prototype.guid=function(a){return++this.lastIds[a]}},{}],18:[function(a,b){var c={};c.zero={x:0,y:0},c.one={x:1,y:1},c.multiply=function(a,b){return{x:a.x*b,y:a.y*b}},c.divide=function(a,b){return{x:a.x/b,y:a.y/b}},c.add=function(a,b){return{x:a.x+b.x,y:a.y+b.y}},c.dif=function(a,b){return{x:b.x-a.x,y:b.y-a.y}},c.part=function(a,b,d){return c.lerp(a,b,d/10)},c.mid=function(a,b){return c.divide(c.add(a,b),2)},c.eql=function(a,b){return a.x===b.x&&a.y===b.y},c.center=function(a,b){return{x:a.x+b.x/2,y:a.y+b.y/2}},c.length=function(a,b){var d=c.dif(a,b);return Math.sqrt(d.x*d.x+d.y*d.y)},c.pointInCircle=function(a,b,d){return c.length(a,b)<d},c.lerp=function(a,b,c){return{x:a.x+(b.x-a.x)*c,y:a.y+(b.y-a.y)*c}},c.round=function(a){return a.x=Math.round(a.x),a.y=Math.round(a.y),a},c.isOut=function(a,b,c){return a.x<b.x||a.x>c.x||a.y<b.y||a.y>c.y},b.exports=c},{}],19:[function(a){a("./reqAnimFrame");var b=a("./GameTime"),c=a("./Utils"),d=a("./Controls");window.Mathf=a("./Mathf"),window.Color=a("./Color"),window.Vector=a("./Vector"),window.Physics=a("./Physics"),window.Renderer=a("./Renderer"),window.DEBUG=!0,window.onload=function(){function e(a){return Math.max(document.documentElement["client"+a],document.body["scroll"+a],document.documentElement["scroll"+a],document.body["offset"+a],document.documentElement["offset"+a])}function f(){game.paused?game.start():game.stop()}var g=document.getElementById("game-viewport"),h=document.getElementById("game-world");window._=new c,window.Time=new b,window.Controls=new d({container:g});var i=a("./Game");window.config=a("./Settings");var j=e("Width"),k=e("Height");window.config.size={x:j-50,y:k-50},window.game=new i({viewport:g,world:h}),window.game.start(),window.Controls.on("pause",f)}},{"./Color":1,"./Controls":2,"./Game":4,"./GameTime":5,"./Mathf":7,"./Physics":12,"./Renderer":13,"./Settings":14,"./Utils":17,"./Vector":18,"./reqAnimFrame":20}],20:[function(){!function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b){var c=(new Date).getTime(),d=Math.max(0,16-(c-a)),e=window.setTimeout(function(){b(c+d)},d);return a=c+d,e}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){window.clearTimeout(a)})}()},{}]},{},[19]);